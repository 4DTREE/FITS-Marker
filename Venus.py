from math import log10, atan, sqrt, sin, cos
import matplotlib.pyplot as plt
import numpy as np

plt.rcParams['font.sans-serif'] = ['STSong'] 
plt.rcParams['axes.unicode_minus'] = False

pi = 3.14159265358979
r = 0.723
R = 6.052/1.496/10**5 
q = 0.689
x1=np.linspace(0,180,180)
x2=np.linspace(0,180,296)

mag1=[ ]
mag3=[ ]
mag2=[-3.33,-2.98,-3.36,-3.67,-3.90,-4.05,-4.10,-4.08,-3.98,-4.05,-4.12,-4.18,-4.23,-4.28,-4.33,-4.37,-4.41,-4.45,-4.48,-4.51,-4.54,-4.56,-4.58,-4.60,-4.62,-4.63,-4.65,-4.66,-4.67,-4.67,-4.68,-4.69,-4.69,-4.69,-4.69,-4.69,-4.69,-4.69,-4.69,-4.69,-4.68,-4.68,-4.67,-4.67,-4.66,-4.66,-4.65,-4.64,-4.64,-4.63,-4.62,-4.61,-4.61,-4.60,-4.59,-4.58,-4.57,-4.56,-4.55,-4.55,-4.54,-4.53,-4.52,-4.51,-4.50,-4.49,-4.48,-4.47,-4.46,-4.46,-4.45,-4.44,-4.43,-4.42,-4.41,-4.40,-4.39,-4.39,-4.38,-4.37,-4.36,-4.35,-4.35,-4.34,-4.33,-4.32,-4.31,-4.31,-4.30,-4.29,-4.28,-4.28,-4.27,-4.26,-4.25,-4.25,-4.24,-4.23,-4.23,-4.22,-4.21,-4.21,-4.20,-4.19,-4.19,-4.18,-4.18,-4.17,-4.16,-4.16,-4.15,-4.15,-4.14,-4.14,-4.13,-4.12,-4.12,-4.11,-4.11,-4.10,-4.10,-4.09,-4.09,-4.08,-4.08,-4.08,-4.07,-4.07,-4.06,-4.06,-4.05,-4.05,-4.04,-4.04,-4.04,-4.03,-4.03,-4.02,-4.02,-4.02,-4.01,-4.01,-4.01,-4.00,-4.00,-4.00,-3.99,-3.99,-3.99,-3.98,-3.98,-3.98,-3.97,-3.97,-3.97,-3.96,-3.96,-3.96,-3.96,-3.95,-3.95,-3.95,-3.95,-3.94,-3.94,-3.94,-3.94,-3.93,-3.93,-3.93,-3.93,-3.92,-3.92,-3.92,-3.92,-3.92,-3.91,-3.91,-3.91,-3.91,-3.91,-3.90,-3.90,-3.90,-3.90,-3.90,-3.90,-3.89,-3.89,-3.89,-3.89,-3.89,-3.89,-3.88,-3.88,-3.88,-3.88,-3.88,-3.88,-3.88,-3.88,-3.88,-3.87,-3.87,-3.87,-3.87,-3.87,-3.87,-3.87,-3.87,-3.87,-3.87,-3.87,-3.87,-3.86,-3.86,-3.86,-3.86,-3.86,-3.86,-3.86,-3.86,-3.86,-3.86,-3.86,-3.86,-3.86,-3.86,-3.86,-3.86,-3.86,-3.86,-3.86,-3.86,-3.86,-3.86,-3.86,-3.86,-3.86,-3.86,-3.86,-3.86,-3.87,-3.87,-3.87,-3.87,-3.87,-3.87,-3.87,-3.87,-3.87,-3.87,-3.87,-3.88,-3.88,-3.88,-3.88,-3.88,-3.88,-3.88,-3.89,-3.89,-3.89,-3.89,-3.89,-3.89,-3.90,-3.90,-3.90,-3.90,-3.90,-3.91,-3.91,-3.91,-3.91,-3.91,-3.92,-3.92,-3.92,-3.92,-3.93,-3.93,-3.93,-3.93,-3.94,-3.94,-3.94,-3.94,-3.95,-3.95,-3.95,-3.95,-3.96,-3.96,-3.96,-3.96]
for i in range(0, 180):
	d = pi/180*i+0.000001
	a = (pi / 2 - d + atan((1-r*cos(d))/r/sin(d)))
	ad=a/pi*180
	D = r * cos(a) + sqrt(1- r*r * sin(a) * sin(a))
	if ad<163.7:
		m1 = -26.8 - 2.5*log10(q*R*R) + 5*log10(r*D)-0.001044*ad+3.687/10000*ad*ad-2.817/10**6*ad**3+8.938/10**9*ad**4
	else:
		m1 = -26.8 - 2.5*log10(q*R*R) + 5*log10(r*D)+240.44288-2.81914*ad+0.00839034*ad*ad
	m2 = -26.8 - 2.5*log10(q*R*R) + 5*log10(r*D)-2.5*log10(2/3*(cos(a)*(1-a/pi)+sin(a)/pi))
	mag1.append(m1)
	mag3.append(m2)


plt.plot(x1,mag3,'r--',x1,mag1,'b--',x2,mag2,'black')
plt.ylim(-2,-5)
plt.legend((r'$\Phi(\alpha)$ 理论值', r'$\Phi\prime(\alpha)$理论值','实际观测值',))
plt.grid(True)

plt.title('图 5  金星的视星等')
plt.xlabel(r'$\delta$/$\degree$')
plt.ylabel('m/星等')

plt.show()
